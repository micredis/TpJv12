grigory.kislin [6:26 AM] 
joined #hw6 along with Few.


grigory.kislin [6:37 AM] 
6е занятие: начинаем изучать Spring-MVC и слой Web:
https://github.com/JavaWebinar/topjava/blob/doc/doc/lesson06.md
Занятие и домашнее задание относительно большие, поэтому следующее занятие будет через 2 недели, 21.12
Отстающие могут догнать группу, остальные- заняться  выпускным проектом.

Планирую 14.12 в 20.00 (Москва, Минск, 19.00 Киев) провести вебинар на тему ~ "Взросление  в программировании".
Буду делать доп. рассылку (+ напишу в slack). Готовьте вопросы по любой теме
GitHub
JavaWebinar/topjava
Contribute to topjava development by creating an account on GitHub.
 
(edited)


itAvgur [6:40 AM] 
joined #hw6 along with 17 others.


chumak [5:26 PM] 
Добрый вечер. А запись вебинара будет (Киев. Из-за разницы во времени+ пробки не уверен что смогу быть онлайн)? Спасибо (edited)


new messages
grigory.kislin [6:04 PM] 
@chumak да, скорее всего будет hangout и видео на youtube


Marina [9:04 PM] 
После накатки патча 6-8 add test validation, idea подчеркивает передачу emptySet в качестве     ролей юзеру и из-за этого выдает ошибку, так и должно быть и это после починится или у меня что-то не так пошло? Накатила следующий патч, но эта ошибка так и осталась.


[9:05] 
вроде написано что только тесты валидации для jdbc не должны работать, а у меня все не работает


Marina [9:17 PM] 
Поняла почему не принимает, у меня у юзера в конструкторе еще должна быть дата рагистрации перед ролями, а в тесте юзер без нее создается,  это я какой-то патч не поставила, где у юзера такой конструктор добавили?


RNG [9:19 PM] 
@Marina Самый первый вроде как, 6_0_фикс. (edited)


Marina [9:23 PM] 
@RNG странно его первым ставила


[9:25] 
смотрю в первом патче, там у юзера не добавляется такой конструктор без даты регистрации


RNG [9:42 PM] 
@Marina только что проверил и у меня тоже валятся тесты с подобной ошибкой


Andrew [11:02 PM] 
Нет нужного конструктора, может один из дальнейших патчей добавит


RNG [11:12 PM] 
Ну можно еще добавить дату в тесты перед проблемным местом (к примеру `new Date()`). (edited)




----- Today December 8th, 2017 -----
Ivanushka [3:22 AM] 
У меня такая же проблема, но вчера заметил, что есть ещё несколько отличий от эталонного кода после накатки патчей, вчера пришлось выкачать всё по новой.


Sergey [10:12 AM] 
Да, подтверждаю. После 8 патча всё валится, следующими патчами не чинится


Сергей Матвеев [10:48 AM] 
залил 11 патч томкат не поднимает  org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [spring/spring-db.xml]: Invocation of init method failed; nested exception is org.hibernate.service.spi.ServiceException: Unable to create requested service [org.hibernate.engine.jdbc.env.spi.JdbcEnvironment


Sergey [11:05 AM] 
RNG+ добавление даты решает проблему, конструктор не нужен.


[11:06] 
У меня после всех патчей не работают тесты jdbcUserServiceTest и InMemoryAdminRestControllerSpringTest Тесты InMemoryAdminRestControllerTest - ignored (Это что значит ?)

Few 
[11:06 AM] 
Домашнее задание HW06

1.1 Починить тесты InMemoryAdminRestControllerSpringTest/InMemoryAdminRestControllerTest (в новой версии Spring классы spring-mvc требуют WebApplicationContext, поэтому поправьте mock.xml)


Sergey [11:16 AM] 
Да, верно это нужно сделать в ДЗ. Второй раз уже дают нерабочий проект и сиди разбирайся, то ли патч не так поставился, то ли задумано так.


Sergey [11:30 AM] 
Ещё патчи расходятся с коммитами, Например тот же AbstractUserServiceTest.java в коммите на 8 патч testValidation с newDate() https://github.com/JavaWebinar/topjava/blob/778176c2001160eac6efdae76fa252c65e40cec4/src/test/java/ru/javawebinar/topjava/service/AbstractUserServiceTest.java А в патче без.
GitHub
JavaWebinar/topjava
Contribute to topjava development by creating an account on GitHub.
 


Ivanushka [2:03 PM] 
На самом деле, это всё не страшно - мы же учимся. Тут важно понять @grigory.kislin специально нас в "миску носом тыкает" или мы где-то сворачиваем не туда по своей невнимательности.


Sergey [3:32 PM] 
После патча 6_14 у меня дочерняя страница валится (meals) валится страница с ошибкой 404. Никакого лога ни в браузере ни в TomCat Log тоже не выдаёт. А после патча 6_15 вообще tomCat валится с ошибкой 500. Логи показывают, что это из за замены fmt на spring в index.jsp Так и должно быть или только у меня упало ?


Chaika [3:32 PM] 
Блин, опять какая-то фигня:) Я накатил патчи до 6.02 , запускаю тесты и сразу java.lang.IllegalStateException: Failed to load ApplicationContext


[3:32] 
Я думал что в дз косячу, решил на ветке master проверить

Few [3:41 PM] 
А почему все думают, что после патчей должно все работать? Как раз в рамках дз часто нужно что-нибудь починить :slightly_smiling_face:


Sergey [3:43 PM] 
ну до 5 занятия после патчей всё работало)


Chaika [4:43 PM] 
это все java 9


[4:43] 
<dependencies>
       <dependency>
           <groupId>com.sun.xml.bind</groupId>
           <artifactId>jaxb-impl</artifactId>
           <version>2.2.11</version>
       </dependency>

       <dependency>
           <groupId>com.sun.xml.bind</groupId>
           <artifactId>jaxb-core</artifactId>
           <version>2.2.11</version>
       </dependency>
       <dependency>
           <groupId>javax.xml.bind</groupId>
           <artifactId>jaxb-api</artifactId>
           <version>2.3.0</version>
       </dependency>
       <dependency>
           <groupId>javax.activation</groupId>
           <artifactId>activation</artifactId>
           <version>1.1.1</version>
       </dependency>


[4:43] 
если будут проблемы)

Sergey [5:00 PM] 
У меня Java 8 используется в проекте


grigory.kislin [5:47 PM] 
коллеги, привет!
1. по поводу нерабочего проекта- в ДЗ написано что чинить и после патчей также стараюсь писать. Учимся мы здесь все таки программировать, а не патчи накатывать и нажимать на зеленую кнопку, поэтому на meals 404 полезно подумать, что произошло. я бы сказал даже что если это не делается, то стажировка прошла даром и нужен повтор
2. в 6_08_add_test_validation действительно ошибка- нужно в вызов конструктора до коллекций добавить new Date(). Патчи я уже вчекинил- то можно сравнить с github
3. наконец воспринимайте все как возможность поучиться. в реальном проекте таких ситуаций будет гораздо больше
4. извиняюсь за опоздание с письмом- сейчас вышлю


MetalBro [3:15 PM] 
Не работают тесты сразу после патчей домашнего HW5, так должно быть? Как вообще тогда проверить правильность?


MetalBro [3:26 PM] 
SEVERE: Unable to create initial connections of pool.
java.sql.SQLException: Driver:org.postgresql.Driver@12365c88 returned null for URL:jdbc:hsqldb:file:D:/temp/topjava


[3:27] 
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [spring/spring-db.xml]: Invocation of init method failed; nested exception is org.hibernate.service.spi.ServiceException: Unable to create requested service [org.hibernate.engine.jdbc.env.spi.JdbcEnvironment]
Caused by: org.hibernate.service.spi.ServiceException: Unable to create requested service [org.hibernate.engine.jdbc.env.spi.JdbcEnvironment]
Caused by: org.hibernate.HibernateException: Access to DialectResolutionInfo cannot be null when 'hibernate.dialect' not set


MetalBro [3:36 PM] 
честно говоря, раздражают очень сильно такие ситуации, когда после решения ДЗ хочешь посмотреть как сделано master


MetalBro [3:54 PM] 
Проблема разрешилась внесением небольшого изменения


[3:54] 
Значит с 6.08 основные проблемы?


Sergey [4:22 PM] 
Да,ещё будут с 6,14 и 6,15

MetalBro [7 hours ago] 
ну те хоть плановые, для ДЗ по новой теме. Считай не проблемы) (edited)


Dmitry Neustupov [6:17 PM] 
@MetalBro У меня тесты работали на всех патчах до 6.08


meldenev.aleksandr [7:38 PM] 
Не подскажете куда копать?  Тест JdbcUserServiceTest,  тест getAll если запускать отдельно, то все ок,  если в составе модуля,  то находит только одну запись в базе (с админом) и, соответственно не проходит. Другие тесты(dataJpa и jpa) при этом работают нормально. (edited)


Few
[8:04 PM] 
ощущение что у тебя между тестами база не восстанавливается


[8:06] 
это ты уже HW6 делаешь?


Few
[8:11 PM] 
еще кэш не валидный может так влиять по идее


meldenev.aleksandr [9:13 PM] 
Больше  похоже на кеш - скрипты запускаются,  по крайней мере в логе пишутся. По поводу кеша,  я думал что мы работаем с кешем хибернейта и на jdbc он не распространяется. Видимо там копать надо.

Few [25 minutes ago] 
Теперь могу с уверенностью сказать, что копать нужно в сторону кэша :slightly_smiling_face:


anpotashev [1:17 AM] 
Кто-нибудь победил фф с его AM PM в поле типа "time"?


Dmitry Makarov [1:18 AM] 
а что не так?


anpotashev [1:19 AM] 
На сервлет/контроллер приходят значения с этими же АМ и РМ


Dmitry Makarov [1:20 AM] 
у меня все ок


anpotashev [1:21 AM] 
А ввод у тебя в 24-часовом формате?


Dmitry Makarov [1:21 AM] 
да


anpotashev [1:21 AM] 
А файрфокс какой версии?


Dmitry Makarov [1:21 AM] 
Quantum 57.0 (64-бит) (edited)


anpotashev [1:23 AM] 
один в один как у меня


Dmitry Makarov [1:23 AM] 
в хроме все ок?

anpotashev [1:23 AM] 
Да


[1:24] 
В tor-е еще так же как в фф


Dmitry Makarov [1:24 AM] 
в торе же Firefox-ESR?


anpotashev [1:24 AM] 
А фф у тебя русская версия?


Dmitry Makarov [1:24 AM] 
русская


anpotashev [1:24 AM] 
А у меня инглиш


[1:25] 
Видимо поэтому и идет западный стандарт


[1:30] 
С тором соврал, похоже

Dmitry Makarov [1:31 AM] 
тор, насколько я помню, не понимает ни время ни дату HTML5


anpotashev [1:33 AM] 
Да, помнил, что что-то у него не так, вот и попутал


[1:34] 
У кого ФФ английский, посмотрите, плиз, как у вас полями типа time, плиз. Заранее спасибо. (edited)


Dinara [1:48 PM] 
Привет всем! ПОдскажите, плиз, совсем не догоняю про дз  - разнести запросы на update/delete/.. по разным методам (попробуйте вообще без action=).


[1:49] 
то есть должно быть несколько методов get и post (отдельный метод для каждой операции), а не так, как у нас сейчас в сервлете?



Katherine Buzatu [2:11 PM] 
uploaded this image: Коллеги, у кого-то было так с локализацией?
Add Comment



Dinara [2:19 PM] 
у меня чую будет примерно так же.. там есть подсказка на эту тему. вы ее применяли уже?


Valery [2:22 PM] 
> то есть должно быть несколько методов get и post
методы можно называть как угодно, не обязательно get и post. Например, те же update, delete, save.
я только лекции еще смотрю, но думаю, это оно.



Dinara [2:23 PM] 
это понятно, что как угодно. не понимаю, как их без анализа этого action различить


Valery [2:27 PM] 
@RequestMapping


Dinara [2:50 PM] 
да, но там же тогда будет action=что-то , чего нам надо избежать

Valery [8 hours ago] 
сейчас у нас запрос уходит в таком виде - href="meals?action=update&id=${meal.id}"
где actions - параметр.
и потом в контроллере мы эти параметры парсим - switch (action == null ? "all" : action). это все в одном методе происходит.


Valery [7 hours ago] 
через mapping получится такое: 
href="meals/update/{meal.id}" (edited)


Dinara [2:50 PM] 
в requestMapping


Katherine Buzatu [2:50 PM] 
uploaded this image: @Dinara это?
Add Comment



Dinara [2:51 PM] 
я про эту подсказку Неверная кодировка UTF-8 с Spring обычно решается фильтром CharacterEncodingFilter:
   <filter>
       <filter-name>encodingFilter</filter-name>
       <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
       <init-param>
           <param-name>encoding</param-name>
           <param-value>UTF-8</param-value>
       </init-param>
       <init-param>
           <param-name>forceEncoding</param-name>
           <param-value>true</param-value>
       </init-param>
   </filter>
   <filter-mapping>
       <filter-name>encodingFilter</filter-name>
       <url-pattern>/*</url-pattern>
   </filter-mapping>


MetalBro [2:58 PM] 
смущает 1.2 Починить Jdbc тесты (валидацию исключить)


[2:59] 
не работает ведь только testValidation, кого чинить? Его?


Valery [3:00 PM] 
тут половина проекта стостоит в починке тестов...


MetalBro [3:01 PM] 
нет, ну что значит валидацию исключить. Работают 9 тестов, один не работает testValidation


Valery [3:01 PM] 
чем же QA тогда должны заниматься гогда разработчики сами тестируют?

MetalBro [3:01 PM] 
я не про это


[3:01] 
ну да, нам тут профиль общий дают)


[3:02] 
условие неясно


MetalBro [3:08 PM] 
аннотацию повесить только что ли


Dmitry Makarov [4:07 PM] 
@MetalBro , насколько я понял, при запуске всех тестов скипнуться должны только 2 метода. Как это сделать в задании приводятся ссылки.



grigory.kislin [5:11 PM] 
@MetalBro после HW5( 6_07_HW5_graph_batch_size) все тесты проходят
`Tests run: 62, Failures: 0`
а после 6_08_add_test_validation в уроке написано ширным шрифтом
`Тесты валидации для Jdbc не работают, нужно будет починить в HW6`
>  раздражают очень сильно такие ситуации
мне кажется тут все дело в твоем отношении к проекту и программированию... если не поменяешь, на работе будет тяжело. посмотри видео якова фейна как стать профессиональным программистом. в программисты требуются люди, которые могут решать проблемы. те не должно быть отношения на работе, что тебе должны решить возникающие у тебя проблемы (а их будет немало) (edited)


MetalBro [5:19 PM] 
уже сделал это все


[5:19] 
просто когда я делал дз по предыдущему заданию, все получилось, делаю патч и снова менять надо. Как оказалось совсем мелочь


[5:21] 
проблема была в том, что контексте по-прежнему не были убраны холдеры     <!--<context:property-placeholder location="classpath:db/hsqldb.properties" system-properties-mode="OVERRIDE"/>-->


[5:22] 
дело не в том, что решать проблемы, а в том, когда заявлено что работает, а оно не работает. Тут я изменюсь вряд ли, конфликты такие были всегда


[5:23] 
исправлять зону ответственности другого никогда не любил)


grigory.kislin [5:27 PM] 
@Valery @MetalBro
> чем же QA тогда должны заниматься гогда разработчики сами тестируют?
> нам тут профиль общий дают)
1. у QA на порядок больше тестов. часто на уровне браузера (типа selenium). 
2. иногда (на маленьких проектах)бывает что QA вообще нет
3. тесты обязательны даже в тестовых заданиях на работу, не говоря уж о проекте


grigory.kislin [5:29 PM] 
@Katherine Buzatu в твоей картинке default encoding for property files ISO-8859-1
поставь UTF-8. и проверь кодировку файлов локализации

Katherine Buzatu [5 hours ago] 
Не помогло. Насильно заменила русские символы на escape-последовательности. Только тогда с галкой в настройках и в Идее читается, и в браузере порядок.


kadmser [7:58 PM] 
После патча 6,09 все jdbc тесты падать должны? У меня JdbcMealServiceTest проходит кроме testValidator


Dinara [7:59 PM] 
Добавлю как действующий QA) QA в очень редких случаях пишут unit тесты, про которые у нас тут речь, это святая обязанность девелопера. И да, чинить тесты приходится очень часто, а так же писать их на новую функциональность тоже. У нас вообще в мастер впушить нельзя код, если с  ним test coverage падает. А те, кто филонят, получают нагоняй)
Grigory Kislin
@Valery @MetalBro
> чем же QA тогда должны заниматься гогда разработчики сами тестируют?
> нам тут профиль общий дают)
1. у QA на порядок больше тестов. часто на уровне браузера (типа selenium). 
2. иногда (на маленьких проектах)бывает что QA вообще нет Show more…
Posted in #hw6Today at 5:27 PM


grigory.kislin [12:40 AM] 
@Katherine Buzatu  ок. еще: escape-последовательности нужны только для jsp. спринг умеет с UTF-8 работать


Few [8:13 AM] 
Добрый день. Не могу до конца осознать как работает формирование пути при использовании href, form action, возвратов из методов контроллера. Как это все друг с другом связано? Иной раз вроде думаешь что вот оно, понял наконец, но в следующий момент находишь место в коде которое работает, хотя вроде не должно :grinning:


[8:13] 
Методом подбора это все конечно решается, но это не вариант. Буду благодарен за хорошую ссылку по этой теме


CRCx86 [8:19 AM] 
здравствуйте! вопрос по патчу 6_04. "зайдите в исходники @Profile и посмотрите (подебажте) его реализацию через @Conditional(ProfileCondition.class)" что значит подебажить через аннотацию?